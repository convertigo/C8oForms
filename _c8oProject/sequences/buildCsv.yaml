↓Input_variables [steps.InputVariablesStep-1570091177916]: 
↓Call_Transaction [steps.TransactionStep-1570091168045]: 
  sourceTransaction: C8Oforms.c8oforms_response_fs.GetDocument
  ↓_use_docid [variables.StepVariable-1570091199075]: 
    description: Document ID
    sourceDefinition: 
      - xmlizable: 
        - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
        - com.twinsoft.convertigo.beans.common.XMLVector: 
          - java.lang.String: 
            - ↑value: 1570091177916
          - java.lang.String: 
            - ↑value: ./formId/text()
↓idForV [steps.SimpleSourceStep-1570107344350]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1570091168045
        - java.lang.String: 
          - ↑value: ./document/couchdb_output/formId/text()
  variableName: idForV
↓Sequence_JS1 [steps.SimpleStep-1570107387228]: 
  expression: |
    //todo
    var idForView = '"'+idForV+'"';
↓jElement [steps.ElementStep-1570107491566]: 
  expression: idForView
  nodeName: myIdForView
  output: false
↓Call_Transaction1 [steps.TransactionStep-1570106205502]: 
  sourceTransaction: C8Oforms.c8oforms_response_fs.GetResponseByFormId
  ↓_use_key [variables.StepVariable-1570106221239]: 
    description: (string) – Return only documents that match the specified key. Optional
    sourceDefinition: 
      - xmlizable: 
        - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
        - com.twinsoft.convertigo.beans.common.XMLVector: 
          - java.lang.String: 
            - ↑value: 1570107491566
          - java.lang.String: 
            - ↑value: ./text()
    value: 
↓jSource [steps.SourceStep-1570112806246]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1570106205502
        - java.lang.String: 
          - ↑value: ./document/couchdb_output/rows
  variableName: rows
↓Complex1 [steps.XMLComplexStep-1570193531859]: 
↓jSource1 [steps.SourceStep-1570193545322]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1570193531859
        - java.lang.String: 
          - ↑value: .
↓Sequence_JS2 [steps.SimpleStep-1570113015989]: 
  expression: |
    '//todo
    function searchRecursive(nodeList, nodePath, lvl){
    	for(var i = 0; i< nodeList.length; i++){
    		var level = lvl;
    		if(level == null){
    			tab.push([]);
    			level = i;
    		}
    		var type = nodeList.item(i).getNodeType();
    		var hasChild = nodeList.item(i).hasChildNodes();
    		
    		 if (hasChild && type != 3) {
    			var paf = nodePath;
    			var nodeName = nodeList.item(i).getNodeName();
    			if(nodeName != "resp"){
    				paf != "" ? paf += separator : null;
    				paf += nodeName; 
    			}
    		}
    		else{
    			var value = "" + nodeList.item(i).getTextContent();
    			if(nodePath != "" && value != ""){
    				var data = {};
    				data.key = nodePath;
    	            data.value = value;
    	            tab[level].push(data);
    			}  
    		}
    	}
    }
    
    
    function createNodeXml(arr){
    	// create parent node
    	//var node = context.addTextNodeUnderRoot("resp", "");
    	var node = myNodeList.item(0);
    	for(var i = 0; i< arr.length; i++){
    		var item = context.addTextNode(node, "item", "");
    		for(var j = 0; j< arr[i].length; j++){
    			log.warning("elem => key: " + arr[i][j]["key"]+" value: "+ arr[i][j]["value"]);
    			var elem = context.addTextNode(item, arr[i][j]["key"],arr[i][j]["value"]);			
    		}
    	}
    }
    
    
    const separator = "_";
    var tab = [];
    var list = rows.item(0).getElementsByTagName("resp");
    var length =rows.item(0).length;
    log.warning("resultat length: " + length);
    searchRecursive(list, "", null);
    log.warning("resultat: " + JSON.stringify(tab))
    createNodeXml(tab);
    /*log.warning("resultat: " + JSON.stringify(tab));
    var tab = JSON.stringify({tab: tab});*/
    /*
    var xmlUtils = use("com.twinsoft.convertigo.engine.util.XMLUtils");
    var jsonObject = new org.codehaus.jettison.json.JSONObject(JSON.stringify(tab));
    xmlUtils.jsonToXml(jsonObject, dom.getDocumentElement());
    
    */
    /*
    function searchRecursive(nodeList, nodePath, lvl){
    for(var i = 0; i< nodeList.length; i++){
    	var level = lvl;
    	if(level == null){
    		tab.push([]);
    		level = i;
    	}
    	var type = nodeList.item(i).getNodeType();
    	var hasChild = nodeList.item(i).hasChildNodes();
    	
    	 if (hasChild && type != 3) {
    		var paf = nodePath;
    		var nodeName = nodeList.item(i).getNodeName();
    		if(nodeName != "resp"){
    			paf != "" ? paf += separator : null;
    			paf += nodeName; 
    		}
    		searchRecursive(nodeList.item(i), paf, level);
    	}
    	else{
    		var value = "" + nodeList.item(i).getTextContent();
    		var data = {};
            data.key = nodePath;
            data.value = value;
            tab[level].push(data);
            
    	}
    }
    }
    */'
↓Write_CSV [steps.WriteCSVStep-1570091048910]: 
  dataFile: '".//csv/" + formId + ".csv"'
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1570193531859
        - java.lang.String: 
          - ↑value: ./item
  titleLine: true
↓Concat [steps.XMLConcatStep-1570094267479]: 
  output: false
  separator: 
  sourcesDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - xmlizable: 
          - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
          - com.twinsoft.convertigo.beans.common.XMLVector: 
            - java.lang.String: 
              - ↑value: description
            - xmlizable: 
              - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
              - com.twinsoft.convertigo.beans.common.XMLVector: 
                - java.lang.String: 
                  - ↑value: 1570091168045
                - java.lang.String: 
                  - ↑value: ./document/couchdb_output/_id/text()
            - java.lang.String: 
              - ↑value: ''
        - xmlizable: 
          - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
          - com.twinsoft.convertigo.beans.common.XMLVector: 
            - java.lang.String: 
              - ↑value: description
            - xmlizable: 
              - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
              - com.twinsoft.convertigo.beans.common.XMLVector: 
            - java.lang.String: 
              - ↑value: .csv
↓jSimpleSource [steps.SimpleSourceStep-1570094452168]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1570094267479
        - java.lang.String: 
          - ↑value: ./text()
  variableName: id
↓Element [steps.XMLElementStep-1570093441393]: 
  nodeName: attachment
  ↓jAttribute [steps.AttributeStep-1570093463250]: 
    nodeName: content-type
    nodeText: application/csv
  ↓jAttribute1 [steps.AttributeStep-1570093467023]: 
    expression: context.getProjectDirectory() + "/csv/"+ id
    nodeName: local-url
  ↓jAttribute2 [steps.AttributeStep-1570196002482]: 
    expression: name+".csv"
    nodeName: name
  ↓jAttribute3 [steps.AttributeStep-1570093468154]: 
    nodeName: type
    nodeText: attachment
↓formId [variables.RequestableVariable-1570090856141]: 
↓name [variables.RequestableVariable-1570195460009]: 
↓Test_Case [core.TestCase]: 
  ↓formId [variables.TestCaseVariable-1570091643590]: 
    value: grimont.c@gmail.com_1567067321897_1570024341583