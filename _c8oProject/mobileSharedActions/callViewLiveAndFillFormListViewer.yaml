↓CallViewLiveAndFillFormList [mobile.components.UICustomAction-1571648363916]: 
  actionValue: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.FormatedContent
      - com.twinsoft.convertigo.beans.common.FormatedContent: 
        →: |
          '		
          
          		    // Calling view live
          		    let key;
          		    let respInit;
          		    if(page.local["formId"]!= null){
          		        key = page.local["formId"];
          		        if(page.local["respInit"] != null){
          		            respInit = page.local["respInit"];
          	                page["edit"] = true;
          		        }
          		    }
          
          		    page.c8o.callJsonObject("fs://c8oforms_fs.view",{
          		        "ddoc": "forms",
          		        "view": "view",
          		        "__live": "view",
          		         "key": key
          		        })
          		        .then((response: any, parameters)=>{
          		            if(!page.local["submitting"]){
          		          // will be call now and after each database update
          		            if(response.rows != undefined){
          		                if(response.rows[0] != undefined){
          		                    
          		                    page["form"] = response.rows[0].value.doc;
          		                    page["formsList"] = response.rows[0].value.doc.formulaire;
          		                    page["link"] = response.rows[0].value.doc["wallpaper"]["link"];
          		                    page["enabled"] = response.rows[0].value.doc["wallpaper"]["enabled"];
          		                    page.c8o.log.debug("CallViewLiveAndFillFormList: formsList object has been updated from live view");
          		                    
          		                
          		                    let fillFormSubmit = (list, redList, formSubmit, response) => {
          		                        try  {
          		                            for(let item of list){
          	                                    if(item["type"] == "ion-card"){
          	                                        redList[item["name"]] = {};
          	                                        formSubmit[item["name"]] = {"name":item["name"], "type": item["type"], "children":{}};
          	                                        //redList[item["name"]]["children"] = [];
          	                                        let res = response != undefined ? response[item["name"]]["children"] : null;
          	                                        fillFormSubmit(item["children"], redList[item["name"]]["children"], formSubmit[item["name"]]["children"], res);
          	                                    }
          	                                    else if(item["type"] == "text"){
          	                                        let value = respInit == null ? "": response[item["name"]]["value"]; 
          	                                        formSubmit[item["name"]] = {"name":item["name"], "type": item["type"], "label":item["config"]["label"], "value":value};
          	                                    }
          	                                    else if(item["type"] == "checkbox"){
          	                                        formSubmit[item["name"]] = {"name":item["name"], "type": item["type"], "label":item["config"]["label"], "children":[]};
          	                                       
          	                                        for(let child in item["children"]){
          	                                            let selected;
          	                                            try {
          	                                                selected = respInit == null ? item["children"][child].selected : response[item["name"]]["children"][child]["selected"];
          	                                            }
          	                                            catch(e){
          	                                                
          	                                            }
          	                                            
          	                                            formSubmit[item["name"]]["children"].push({"value": item["children"][child].value, "selected": selected});
          	                                        }
          	                                    }
          	                                    else if(item["type"] == "radio" || item["type"] == "select"){
          	                                        
          	                                        formSubmit[item["name"]] = {"name":item["name"], "type": item["type"], "label":item["config"]["label"], "children":[]};
          	                                        
          	                                            let defaultSelected ="";
          	                                            for(let child in item["children"]){
          	                                                let selected;
          	                                                try {
          	                                                    selected = respInit == null ? item["children"][child].selected : response[item["name"]]["children"][child]["selected"];
          	                                                    if(selected){
          	                                                        defaultSelected = respInit == null ? item["children"][child].value : response[item["name"]]["children"][child]["value"];
          	                                                    }
          	                                                }
          	                                                catch(e){
          	                                                    
          	                                                }
          	                                                
          	                                                formSubmit[item["name"]]["children"].push({"value": item["children"][child].value, "selected": selected});
          	                                            }
          	                                            formSubmit[item["name"]]["value"] = defaultSelected;
          	                                       
          	                                        
          	                                    }
          	                                    else if(item["type"] == "slider" || item["type"] == "datetime" || item["type"] == "time" || item["type"] == "barcode" || item["type"] == "img" || item["type"] == "file"|| item["type"] == "signature"){
          	                                        let value = respInit == null ? "": response[item["name"]]["value"]; 
          	                                        formSubmit[item["name"]] = {"name":item["name"], "type": item["type"], "label":item["name"], "value":value};
          	                                    }
          	                                    
          	                            };
          		                        }
          		                        catch(e){
          		                            console.log("error");
          		                            console.log(e);
          		                        }
          		                        
          		                    }
          		                    
          		                    
          		                    fillFormSubmit(page["formsList"], page["redList"], page["formsSubmit"], respInit); 
          		                    
          		                    // do stuff to support upload files
          		                    if(page.global["__C8O_TODELETE"] == undefined){
          		                        page.global["__C8O_TODELETE"] = [];
                                      }
                                      let nullBefore = false;
                                      if(page.global[page["idFiles"]].length == 0){
                                          nullBefore = true
                                      }
                                      for(let item of page["formsList"]){
                                          if( item[''type''] == "file"){
                                              if(page.global[page["idFiles"]][item["id"]] == null){
                                                  page.global[page["idFiles"]][item["id"]] = [];
                                              }
                                          }
                                          if(item["type"] =="ion-card"){
                                              for(let child of item["children"]){
                                                  if(child[''type''] == "file"){
                                                      if(page.global[page["idFiles"]][child["id"]] == null){
                                                          page.global[page["idFiles"]][child["id"]] = [];
                                                      }
                                                  }
                                              }
                                          }
                                      }
                                      
                                      
          		                    
          		                    if(respInit == null){
          		                                  
          	                        }
          		                    else{
          		                        if(page.global["__C8O_TODELETE"] == undefined){
          		                            page.global["__C8O_TODELETE"] = [];
                                          }
                                          let nullBefore = false;
                                          if(page.global[page["idFiles"]].length == 0){
                                              nullBefore = true
                                          }
                                          for(let item of page["formsList"]){
                                              if( item[''type''] == "file"){
                                                  if(page.global[page["idFiles"]][item["id"]] == null){
                                                      page.global[page["idFiles"]][item["id"]] = [];
                                                  }
                                              }
                                              if(item["type"] =="ion-card"){
                                                  for(let child of item["children"]){
                                                      if(child[''type''] == "file"){
                                                          if(page.global[page["idFiles"]][child["id"]] == null){
                                                              page.global[page["idFiles"]][child["id"]] = [];
                                                          }
                                                      }
                                                  }
                                              }
                                          }
                                          for(let item in page.global[''formSelected''][''_attachments'']){
                                              //first itemid
                                              let itemid = item.substring(0, item.indexOf(''_C80C80_''));
                                              //second namefile
                                              let name = item.substring(item.indexOf(''_C80C80_'')+8,item.lastIndexOf(''_C80C80_''));
                                              //synthax
                                              if(page.global[page["idFiles"]][itemid] == null){
                                                  page.global[page["idFiles"]][itemid] = [];
                                              }
                                              if(nullBefore){
                                                  page.global[page["idFiles"]][itemid].push({name:name,path:item, deleted:false});
                                              }
                                          }
                                          
          		                    }
          		                        
          		                        
          		                        
          		                        
          		                        
          		                        
          		                        /*
          		                        for(var i =0; i< this.formsList.length; i++){
                                              if(this.formsList[i]["type"]=="ion-card"){
                                                  this.redList[this.formsList[i]["name"]] = {};
                                                  this.formsSubmit[this.formsList[i]["name"]] = {"name":this.formsList[i]["name"], "type":this.formsList[i]["type"], "children":[]};
                                                  for(let child of this.formsList[i]["children"]){
                                                      this.formsSubmit[this.formsList[i]["name"]]["children"].push({"type":child["type"], "name": child["name"], "value":""})
                                                  }
                                              }
                                              else if(this.formsList[i]["type"]=="select"){
                                                  this.redList[this.formsList[i]["name"]] = {};
                                                  this.formsSubmit[this.formsList[i]["name"]] = {"name":this.formsList[i]["name"], "type":this.formsList[i]["type"], "children":""};
                                              }
                                          }*/
          		                    //}
          		                    
          		                    
          		                    
          		                    
          		                    
          		                    
          		                    
          		                    /*
          		                    
          		                    
          		                    
          		                    //
          	                        if(respInit != null){
          	                            this.formsSubmit = respInit;
          	                            
          	                            for(var i =0; i< this.formsList.length; i++){
                                              if(this.formsList[i]["type"]=="ion-card"){
                                                  this.redList[this.formsList[i]["name"]] = {};
                                              }
                                          }
          	                            if(this.global["__C8O_TODELETE"] == undefined){
                                              this.global["__C8O_TODELETE"] = [];
                                          }
          	                            let nullBefore = false;
          	                            if(this.global[this.idFiles].length == 0){
                                              nullBefore = true
          	                            }
          	                            for(let item of this.formsList){
                                              if( item[''type''] == "file"){
                                                  if(this.global[this.idFiles][item["id"]] == null){
                                                      this.global[this.idFiles][item["id"]] = [];
                                                  }
                                              }
                                              if(item["type"] =="ion-card"){
                                                  for(let child of item["children"]){
                                                      if(child[''type''] == "file"){
                                                          if(this.global[this.idFiles][child["id"]] == null){
                                                              this.global[this.idFiles][child["id"]] = [];
                                                          }
                                                      }
                                                  }
                                              }
                                          }
          	                            for(let item in this.global[''formSelected''][''_attachments'']){
          	                                //first itemid
          	                                let itemid = item.substring(0, item.indexOf(''_C80C80_''));
          	                                //second namefile
          	                                let name = item.substring(item.indexOf(''_C80C80_'')+8,item.lastIndexOf(''_C80C80_''));
          	                                //synthax
          	                                if(this.global[this.idFiles][itemid] == null){
          	                                    this.global[this.idFiles][itemid] = [];
          	                                }
          	                                if(nullBefore){
          	                                    this.global[this.idFiles][itemid].push({name:name,path:item, deleted:false});
          	                                }
          	                            }
          	                            
                                      
          	                        }
          	                        else{
          	                            for(var i =0; i< this.formsList.length; i++){
          	                                if(this.formsList[i]["type"]=="ion-card"){
          	                                    this.redList[this.formsList[i]["name"]] = {};
          	                                    this.formsSubmit[this.formsList[i]["name"]] = {}; 
          	                                    for(let item of this.formsList[i]["children"]){
          	                                        if(item[''type''] == "checkbox"){
          	                                            for(let child of item["children"]){
          	                                                if(this.formsSubmit[this.formsList[i]["name"]][item[''name'']] == undefined){
                                                                  this.formsSubmit[this.formsList[i]["name"]][item[''name'']] = {};
                                                              }
          	                                                if(child.selected == true){
          	                                                    
          	                                                    this.formsSubmit[this.formsList[i]["name"]][item[''name'']][child["value"]] = true
          	                                                }
          	                                            }
          	                                        }
          	                                        if(item[''type''] == "select"){
                                                          for(let child of item["children"]){
                                                              if(child.selected == true){
                                                                  this.formsSubmit[this.formsList[i]["name"]][item[''name'']] = child["value"]
                                                              }
                                                          }
                                                      }
          	                                        if(item[''type''] == "radio"){
                                                          for(let child of item["children"]){
                                                              if(child.selected == true){
                                                                  this.formsSubmit[this.formsList[i]["name"]][item[''name'']] = child["value"]
                                                              }
                                                          }
                                                      }
          	                                    }
          	                                }
          	                            }
          	                        }
          	                        
          	                        
          	                        */
          	                        /*
          	                        //if(!this.edit){
          	                        for(let item of this.formsList){
          	                            
          	                           if(item[''type''] == "checkbox"){
          	                                if(this.formsSubmit[item[''name'']] == undefined){
                                                  this.formsSubmit[item[''name'']] = {};
                                                  
                                              }
          	                                for(let child of item["children"]){
          	                                    if(child.selected == true){
          	                                        this.formsSubmit[item[''name'']][child["value"]] = true
          	                                    }
          	                                }
          	                            }
          	                            else if( item[''type''] == "select"){
                                              for(let child of item["children"]){
                                                  if(child.selected == true){
                                                      this.formsSubmit[item[''name'']] = child["value"];
                                                  }
                                              }
                                          }
          	                            else if( item[''type''] == "radio"){
                                              for(let child of item["children"]){
                                                  if(child.selected == true){
                                                      this.formsSubmit[item[''name'']] = child["value"];
                                                  }
                                              }
                                          }
          	                            else if( item[''type''] == "file"){
          	                                if(this.global[this.idFiles][item["id"]] == null){
          	                                    this.global[this.idFiles][item["id"]] = [];
          	                                }
                                         }
          	                            else if(item["type"] =="ion-card"){
          	                                for(let child of item["children"]){
          	                                    if(child[''type''] == "file"){
          	                                        if(this.global[this.idFiles][child["id"]] == null){
          	                                            this.global[this.idFiles][child["id"]] = [];
          	                                        }
          	                                    }
          	                                }
          	                           }
          	                           //in any case
          	                           //this.formsSubmit[item[''name'']]["c8o_attr"] = item[''type''];
          	                        }
          	                        //}
          		                   */
          		                    resolve();
          		                }
          		             }
          		            return null;
          		            }
          		        })
          		        .fail((err)=>{
          		            page.c8o.log.error("CallViewLiveAndFillFormList: " + JSON.stringify(err.message));
          		        });
          '